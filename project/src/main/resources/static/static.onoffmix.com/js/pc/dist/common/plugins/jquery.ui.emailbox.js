!function(c){c.widget("ui.emailbox",{options:{positionOptions:{my:"left top",at:"left bottom-1",collision:"none"},domainList:["naver.com","gmail.com","hanmail.net","nate.com","daum.net","hotmail.com","empal.com","korea.com","dreamwiz.com","paran.com","yahoo.com","hanmir.com","msn.com"],validate:!1,validateRemote:!1,triggerChange:!1,maxLength:64,width:null},_create:function(){var e,i,a,o,t,n=this.options,s=this.element;this.wrapper=t=c("<span>").append('<span class="at">@</span>').addClass("ui-"+this.widgetName).insertBefore(this.element),this.options.predigestedDomainList=this.digestDomainList(),s.hide(),0<s.attr("maxlength")&&(n.maxLength=s.attr("maxlength")),void 0===s.attr("name")&&s.attr("name","email"),e=c("<input>").attr({maxlength:n.maxLength-5}).addClass(this.widgetFullName+"-account").prependTo(t),this.domain=i=c("<input>").attr({maxlength:n.maxLength-2}).addClass(this.widgetFullName+"-domain").appendTo(t).autocomplete({delay:0,minLength:0,source:c.proxy(this.source,this),position:n.positionOptions,open:function(t,e){c(this).autocomplete("widget").width(n.width?n.width:i.outerWidth()+a.outerWidth()-3)},focus:function(t,e){return!1},select:function(t,e){return i.val(e.item.value).trigger("change"),!1}}).on("keyup change",function(t){var e=t.keyCode,a=c.ui.keyCode;"keyup"==t.type&&e!=a.PAGE_UP&&e!=a.PAGE_DOWN&&e!=a.UP&&e!=a.DOWN&&e!=a.TAB&&e!=a.ENTER&&e!=a.NUMPAD_ENTER&&e!=a.ESCAPE&&0<this.value.length&&i.autocomplete("search")}).on("focus",function(t){i.add(a).addClass("ui-state-focus"),a.addClass("ui-state-focus")}).on("blur",function(t){i.add(a).removeClass("ui-state-focus")}).on("focusout",function(t){i.val(i.val().replace(/(^\s*)|(\s*$)/gi,"")),s.val(e.val()+"@"+i.val())}),i.autocomplete("widget").addClass(this.widgetFullName+"-menu shinyScrollbar"),i.data("ui-autocomplete")._renderItem=function(t,e){return c("<li></li>").data("ui-autocomplete-item",e).append(c("<a></a>").html(e.label)).appendTo(t)};var l=s.val();if(-1<l.search("@")){var r=l.split("@");e.val(r[0]),i.val(r[1])}e.add(i).addClass(s.attr("class")),a=c("<a>").attr({tabIndex:-1}).appendTo(t).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass(this.widgetFullName+"-button ui-button-icon").bind("mouseleave",function(t){i.hasClass("ui-state-focus")&&a.addClass("ui-state-focus")}).bind("click",function(){i.addClass("ui-state-focus"),i.autocomplete("widget").is(":visible")?i.autocomplete("close"):(c(this).blur(),i.autocomplete("search",""))});var u=null;if(e.add(i).on("keyup change",function(t){s.val(e.val()+"@"+i.val()),n.triggerChange&&s.trigger("change"),n.validate&&o&&("keyup"==t.type&&o.settings.onkeyup||"change"==t.type&&o.settings.onfocusout)&&(o.element(s),u&&clearTimeout(u),u=setTimeout(function(){i.autocomplete("widget").filter(":visible").position({my:n.positionOptions.my||"left top",at:n.positionOptions.at||"left bottom",of:i,collision:"none"})},100))}).on("focusout",function(t){e.val(e.val().replace(/(^\s*)|(\s*$)/gi,"")),s.val(e.val()+"@"+i.val())}),c(document).bind("mousedown."+this.widgetName,function(t){try{if(c.contains(i.autocomplete("widget").get(0),t.target)||0<i.autocomplete("widget").filter(t.target).length||c.contains(a.get(0),t.target)||0<a.filter(t.target).length)return;i.autocomplete("close").add(a).removeClass("ui-state-focus")}catch(t){c(document).unbind("mousedown."+this.widgetName)}}),void 0===(o=c.data(this.element.get(0).form,"validator")))n.validate=!1;else{o.settings.ignore=o.settings.ignore+",."+this.widgetFullName+"-account,."+this.widgetFullName+"-domain",s.rules("add",{required:!0,email:!0,messages:{required:"이메일을 입력해 주세요.",email:"이메일 형식에 맞게 입력해 주세요."}}),n.validateRemote&&s.rules("add",{remote:{url:"/_/xmlProxy/xmlProxy.ofm",type:"post",data:{url:base_apiUrl+"/account/checkEmail",output:"json",email:function(){return s.val()}},beforeSend:function(t,e){if(s.val()==s.get(0).defaultValue)return o.stopRequest(s.get(0),!1),s.get(0).form.elements.checkEmail&&c(s.get(0).form.elements.checkEmail).val("1").valid(),!1},error:function(t,e){"timeout"==t?alert("서버와의 연결이 원활하지 않습니다. 잠시후에 다시 시도해주세요."):"parsererror"==t&&alert("서버의 동작이 원활하지 않습니다. 잠시후에 다시 시도해주세요.")},complete:function(t,e,a){"success"!=e&&o.stopRequest(s.get(0),!1),s.valid()?s.trigger("valid-form"):s.trigger("invalid-form"),s.get(0).form.elements.checkEmail&&c(s.get(0).form.elements.checkEmail).val(s.valid()?"1":"0").valid()},timeout:1e4}});var m=this.widgetFullName.concat("-",(new Date).getTime());e.attr("id",m.concat("-account")),i.attr("id",m.concat("-domain"))}},source:function(t,e){var n=this.options.domainList,s=this.options.predigestedDomainList,l=[],r=t.term;this.domain.autocomplete("widget");c.each(s,function(t,e){var a,i=s[t],o=n[t];-1<i.indexOf(r)&&(0<r.length&&(a=o.replace(r,"<em>"+r+"</em>")),l[l.length]={label:a,value:o})}),e(l)},_setOption:function(t,e){"domainList"==t&&(this.options.predigestedDomainList=this.digestDomainList()),c.Widget.prototype._setOption.apply(this,arguments)},digestDomainList:function(t){var e=this.options.domainList,a=[];return c.each(e,function(t,e){e.lastIndexOf(".com")==e.length-4?e=e.substring(0,e.length-4):e.lastIndexOf(".net")==e.length-4?e=e.substring(0,e.length-4):e.lastIndexOf(".co.kr")==e.length-6&&(e=e.substring(0,e.length-6)),a[t]=e}),a},destroy:function(){this.wrapper.remove(),this.element.show(),c.Widget.prototype.destroy.call(this)}})}(jQuery);